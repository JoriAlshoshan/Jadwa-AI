{% extends "base.html" %}
{% load i18n %}

{% block content %}

    <title>Admin Dashboard</title>
    <style>
        body { font-family: Tahoma; background:#f4f6f9; padding:20px; }
        .tabs { display:flex; gap:10px; margin-bottom:20px; }
        .tab-btn {
            padding:10px 20px;
            border:none;
            background:#ddd;
            cursor:pointer;
            border-radius:5px;
        }
        .tab-btn.active { background:#0a2fbf; color:white; }

        .tab-content { display:none; background:white; padding:20px; border-radius:10px; }
        .tab-content.active { display:block; }

        .cards { display:flex; gap:20px; }
        .card {
            background:#0a2fbf;
            color:white;
            padding:20px;
            border-radius:10px;
            width:200px;
            text-align:center;
        }

        table { width:100%; border-collapse:collapse; }
        th, td { padding:10px; border-bottom:1px solid #ddd; text-align:center; }

        textarea { width:100%; height:100px; }
    </style>
</head>
<body>

<h1>Admin Dashboard</h1>

<!-- Tabs-->
<div class="tabs">
    <button class="tab-btn active" onclick="showTab('dashboard')">Statistics</button>
    <button class="tab-btn" onclick="showTab('users')">Users</button>
    <button class="tab-btn" onclick="showTab('messages')">Messages</button>
    <button class="tab-btn" onclick="showTab('content')">Site content</button>
</div>

<!-- Tab: Dashboard -->
<div id="dashboard" class="tab-content active">
    <div class="cards">
        <div class="card">
            <h3>Users number</h3>
            <p>{{ users_count }}</p>
        </div>
        <div class="card">
            <h3>Projects number</h3>
            <p>{{ projects_count }}</p>
        </div>
        <div class="card">
            <h3>Messages</h3>
            <p>{{ messages|length }}</p>
        </div>
    </div>
</div>

<!-- Users -->
<div id="users" class="tab-content">
    <h2>Users</h2>
    <table>
        <tr style="background:#ddd;">
            <th>Name</th>
            <th>Email</th>
            <th>Actions</th>
        </tr>
        {% for user in users %}
        <tr>
            <td>{{ user.username }}</td>
            <td>{{ user.email }}</td>
            <td>
                 <a href="{% url 'user_detail' user.id%}">Details</a> 
                <a href="{% url 'delete_user' user.id%}">Delete</a>
                <a href="{% url 'user_projects' user.id%}">Projects</a>
            </td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="2"> There is no users</td>
        </tr>
        {% endfor %}
    </table>
</div>

<!-- Messages -->
<div id="messages" class="tab-content">
    <table>
        <tr style="background:#ddd;">
            <th>Name</th>
            <th>Email</th>
            <th>Topic</th>
            <th>Date</th>
            <th>details</th>
        </tr>

        {% for msg in messages %}
        <tr>
            <td>{{ msg.full_name }}</td>
            <td>{{ msg.email }}</td>
            <td >{{ msg.topic }}</td>
            <td>{{ msg.created_at }}</td>
            <td> <a href= "{% url 'message_detail' msg.id %}">Open message</a>
            </td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="5" style="text-align:center;">There is no messages</td>
        </tr>
        {% endfor %}
    </table>
</div>

<!-- Content -->
<div id="content" class="tab-content">
    <h2>Site content</h2>

    <table>
        <tr style="background:#ddd;">
            <th> page </th>
            <th> Content </th>
            <th> Edit</th>
        </tr>
        {% for cont in contents %}
        <tr>
            <td> {{ cont.key }}</td>
            <td> {{ cont.content| truncatechars:50 }}</td>
            <td>
                <a href = "{% url 'edit_content' cont.key}"> Edit</a>
            </td>
        </tr>
        {% endfor %}
    </table>
    
</div>

<script>
function showTab(tabId){
    let tabs = document.querySelectorAll(".tab-content");
    let btns = document.querySelectorAll(".tab-btn");

    tabs.forEach(t => t.classList.remove("active"));
    btns.forEach(b => b.classList.remove("active"));

    document.getElementById(tabId).classList.add("active");
    event.target.classList.add("active");
}
</script>

</body>


{% endblock %}
